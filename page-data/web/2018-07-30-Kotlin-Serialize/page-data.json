{"componentChunkName":"component---src-templates-blog-post-js","path":"/web/2018-07-30-Kotlin-Serialize/","result":{"data":{"site":{"siteMetadata":{"title":"Archived by Sujin","author":"sujin-park","siteUrl":"https://sujin-park.github.io","comment":{"disqusShortName":"","utterances":"sujin-park/sujin-park.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"14e0d0ba-95af-5a6e-ae15-73ebfb3e04ee","excerpt":"특정 데이터가 Serialize 되지 않을 때 Kotlin 과 JPA로 개발을 하다가 특정 데이터를 특정 값으로 아무리 insert해도 값이 변하지 않고 초기 값으로 저장되는 것을 확인했다. 문제를 해결하려 계속 이것저것 설정을 바꿔보던 와중에 알게 되었다. 자꾸 값이 저장되지 않고 문제가 생기던 부분 어떤 부분이 잘못된지 모르고 계속 다른 설정만 변경해보다가 return 해주는 json 데이터에 isDeleted 가 보이지 않는다는 것을 뒤늦게 깨닫고.. Serialize…","html":"<h1 id=\"특정-데이터가-serialize-되지-않을-때\" style=\"position:relative;\"><a href=\"#%ED%8A%B9%EC%A0%95-%EB%8D%B0%EC%9D%B4%ED%84%B0%EA%B0%80-serialize-%EB%90%98%EC%A7%80-%EC%95%8A%EC%9D%84-%EB%95%8C\" aria-label=\"특정 데이터가 serialize 되지 않을 때 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>특정 데이터가 Serialize 되지 않을 때</h1>\n<p><strong>Kotlin 과 JPA로 개발</strong>을 하다가 특정 데이터를 특정 값으로 아무리 insert해도 값이 변하지 않고 초기 값으로 저장되는 것을 확인했다. 문제를 해결하려 계속 이것저것 설정을 바꿔보던 와중에 알게 되었다.</p>\n<p>자꾸 값이 저장되지 않고 문제가 생기던 부분</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Entity</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"member\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation builtin\">@EntityListeners</span><span class=\"token punctuation\">(</span>AuditingEntityListener<span class=\"token operator\">::</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> Member <span class=\"token punctuation\">{</span>\n\n<span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token annotation builtin\">@Column</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"is_deleted\"</span></span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"tinyint\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> isDeleted <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n<span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>어떤 부분이 잘못된지 모르고 계속 다른 설정만 변경해보다가 return 해주는 json 데이터에 isDeleted 가 보이지 않는다는 것을 뒤늦게 깨닫고.. Serialize 문제라는 것을 그제서야 알았다…!</p>\n<p><code class=\"language-text\">spring framework, 그리고 kotlin 언어에서</code> <code class=\"language-text\">dto</code>나 <code class=\"language-text\">domain</code>객체를 이용한 <code class=\"language-text\">JSON</code>의 직렬화/역직렬화(serialize/deserialize)를 할때, <strong>isDeleted, isAccepted, isApproved</strong> 등 `is로 시작하는 column명은 직렬화를 해주지 않아서 계속 값도 변하지 않고 응답 객체에서도 포함이 되지 않았던 것이다..</p>\n<p>is 로 시작하는 column명을 직렬화 해주지 않는 부분에 대해서는 kotlin reference에서 찾아 볼 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Boolean accessor methods (where the name of the getter starts with is\nand the name of the setter starts with set) are represented as properties\nwhich have the same name as the getter method.</code></pre></div>\n<p><strong>kotlin 에서 Boolean 타입은 getter 가 is로 시작되고</strong> setter 는 Java처럼 set 으로 시작되는 부분때문에,\n아마 예약어로 받아들여 직렬화가 안됐던 것 같다…</p>\n<p>그래서 아래 코드와 같이 @JsonProperty 를 추가해주니 정상적으로 되었다!</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Entity</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"member\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation builtin\">@EntityListeners</span><span class=\"token punctuation\">(</span>AuditingEntityListener<span class=\"token operator\">::</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> Member <span class=\"token punctuation\">{</span>\n\n<span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token annotation builtin\">@JsonProperty</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"isDeleted\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation builtin\">@Column</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"is_deleted\"</span></span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"tinyint\"</span></span><span class=\"token punctuation\">,</span> length <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> isDeleted <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n<span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>단순하게 @JsonProperty를 이용하여 문제를 해결하였는데, 이 외에도 access 설정해주는 부분도 있어서 참고로 링크를 정리해둔다.</p>\n<p><a href=\"http://eglowc.tistory.com/28\">@JsonProperty 를 이용한 접근 제어 - 응답값에 포함하지 않기</a></p>\n<p><strong>참고</strong></p>\n<p><a href=\"http://kotlinlang.org/docs/reference/java-interop.html\">Kotlin Reference</a></p>","frontmatter":{"title":"특정 데이터가 Serialize 되지 않을 때","date":"July 30, 2018"}}},"pageContext":{"slug":"/web/2018-07-30-Kotlin-Serialize/","previous":{"fields":{"slug":"/conference/2018-03-25-Oracle-Meetup/"},"frontmatter":{"title":"미래의 Java와 손에 잡히는 Microservice - Oracle Meetup 4th!","category":"conference","draft":false}},"next":{"fields":{"slug":"/conference/2020-05-05-Kakao-meetup/"},"frontmatter":{"title":"Kakao FE(Front end) meetup, 1st 후기","category":"conference","draft":false}}}},"staticQueryHashes":["3128451518","521680639"]}